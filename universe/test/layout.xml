<?xml version="1.0" encoding="UTF-8"?>
<world geist="nes">
	<vertical id="main">
		<horizontal split-weight="1">
			<vertical>
				<widget widget-klass="nes-screen" fit="fit" id="nes">
					<xobject>
						<xstring name="rom">__roms__/alter_ego/Alter_Ego.nes</xstring>
					</xobject>
				</widget>
				<horizontal>
					<button text="Lesson1" split-weight="1"> Geist.loadNES("__roms__/workshop/rom1.nes"); </button>
					<button text="AlterEgo" split-weight="1"> Geist.loadNES("__roms__/alter_ego/Alter_Ego.nes"); </button>
				</horizontal>
				<horizontal>
					<button text="Lesson2" split-weight="1"> Geist.loadNES("__roms__/workshop/rom2.nes"); </button>
					<button text="TETRIS" split-weight="1">Geist.loadNES("__roms__/lj65/lj65.nes");</button>
				</horizontal>
				<horizontal>
					<button text="" split-weight="1"></button>
					<button text="" split-weight="1"></button>
				</horizontal>
				<widget widget-klass="nes-trace" widget-id="nes-trace" fit="expand" split-weight="1" />
			</vertical>
			<vertical split-weight="1">
				<horizontal split-weight="2" id="content">
					<scroll mode="vertical" id="memory-compare" split-weight="1">
						<widget widget-klass="nes-compare" widget-id="nes-compare" fit="expand" />
					</scroll>
					<scroll mode="vertical" id="memory-viewer" split-weight="1">
						<widget title="NES" widget-klass="nes-memory" widget-id="nes-watcher" fit="expand" />
					</scroll>
				</horizontal>
				<horizontal>
					<vertical split-weight="1">
						<label text="値を検索" />
						<textarea desc="この値と比較して" id="cmpval" />
						<horizontal>
							<button text="同じ" split-weight="1">
								Geist.selectConstEq(World.findElementById("cmpval").getText().toInteger());
							</button>
							<button text="違う" split-weight="1">
								Geist.selectConstNe(World.findElementById("cmpval").getText().toInteger());
							</button>
						</horizontal>
						<horizontal>
							<button text="大きい" split-weight="1">
								Geist.selectConstGt(World.findElementById("cmpval").getText().toInteger());
							</button>
							<button text="小さい" split-weight="1">
								Geist.selectConstLt(World.findElementById("cmpval").getText().toInteger());
							</button>
						</horizontal>
						<horizontal>
							<button text="以上" split-weight="1">
								Geist.selectConstGe(World.findElementById("cmpval").getText().toInteger());
							</button>
							<button text="以下" split-weight="1">
								Geist.selectConstLe(World.findElementById("cmpval").getText().toInteger());
							</button>
						</horizontal>
					</vertical>
					<vertical split-weight="1">
						<button text="記録メモを取る">
								Geist.selectTakeSnapshot();
								World.findElementById("select-ne").setEnabled(true);
								World.findElementById("select-eq").setEnabled(true);
								World.findElementById("select-ge").setEnabled(true);
								World.findElementById("select-le").setEnabled(true);
								World.findElementById("select-gt").setEnabled(true);
								World.findElementById("select-lt").setEnabled(true);
						</button>
						<label text="記録メモと比較して" />
						<horizontal>
							<button id="select-ne" text="変わってない" split-weight="1" enabled="false">
								Geist.selectEq();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
							<button id="select-eq" text="変わった" split-weight="1" enabled="false">
								Geist.selectNe();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
						</horizontal>
						<horizontal>
							<button id="select-gt" text="大きくなった" split-weight="1" enabled="false">
								Geist.selectGt();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
							<button id="select-lt" text="小さくなった" split-weight="1" enabled="false">
								Geist.selectLt();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
						</horizontal>
						<horizontal>
							<button id="select-ge" text="同じか大きく" split-weight="1" enabled="false">
								Geist.selectGe();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
							<button id="select-le" text="同じか小さく" split-weight="1" enabled="false">
								Geist.selectLe();
								World.findElementById("select-ne").setEnabled(false);
								World.findElementById("select-eq").setEnabled(false);
								World.findElementById("select-ge").setEnabled(false);
								World.findElementById("select-le").setEnabled(false);
								World.findElementById("select-gt").setEnabled(false);
								World.findElementById("select-lt").setEnabled(false);
							</button>
						</horizontal>
					</vertical>
				</horizontal>
				<button text="候補をリセット">
					Geist.selectReset();
					World.findElementById("select-ne").setEnabled(false);
					World.findElementById("select-eq").setEnabled(false);
					World.findElementById("select-ge").setEnabled(false);
					World.findElementById("select-le").setEnabled(false);
					World.findElementById("select-gt").setEnabled(false);
					World.findElementById("select-lt").setEnabled(false);
				</button>
			</vertical>
		</horizontal>
		<horizontal>
			<button text="ステップ" id="step">
				if(!Global.has("step_break")) {
					Global.step_break = Geist.addExecBreak(0,0xffff);
				}else if( Global.step_break == 0 ){
					Global.step_break = Geist.addExecBreak(0,0xffff);
				}else{
					Geist.stepRunning();
				};
				World.findElementById("continue").setEnabled(true);
			</button>
			<button text="再開" id="continue" enabled="false">
				Geist.continueRunning();
				Global.step_break = 0;
				World.findElementById("continue").setEnabled(false);
			</button>
			<label split-weight="1" id="status" />
			<clockbutton text="戻る" op="back" />
			<clockbutton text="進む" op="forward" />
		</horizontal>
	</vertical>
	<label id="label" text="NES"></label>
	<horizontal id="mem-edit">
		<textarea id="val" desc="値を入力" />
		<button text=" 変更 ">
			angel = Global.__mem__widget_angel;
			elm = angel.findElementById("val");
			res = Geist.writeNES(Global.__mem__widget_addr, elm.getText());
			if( !res.isEmpty() ) {
				elm.setFrameColor("red");
				World.findElementById("status").setText(res);
			}else{
				World.findElementById("status").setText("");
				World.heaven().detatchAngel(angel);
				Global.__mem__widget_angel = null;
			};
		</button>
	</horizontal>
	<horizontal id="asm-edit">
		<textarea id="val" desc=" コンパイル " />
		<button text=" 変更 ">
			angel = Global.__mem__widget_angel;
			elm = angel.findElementById("val");
			res = Geist.writeAsmNES(Global.__mem__widget_addr, elm.getText());
			if( !res.isEmpty() ) {
				elm.setFrameColor("red");
				World.findElementById("status").setText(res);
			}else{
				World.findElementById("status").setText("");
				World.heaven().detatchAngel(angel);
				Global.__mem__widget_angel = null;
			};
		</button>
	</horizontal>
</world>

